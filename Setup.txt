#install arkade

arkade get kind
arkade get kubectl
arkade get faas-cli

#set up kind registery

arkade install openfaas

PASSWORD=$(kubectl get secret -n openfaas basic-auth -o jsonpath="{.data.basic-auth-password}" | base64 --decode; echo)

echo -n $PASSWORD | faas-cli login -s

kubectl port-forward -n openfaas svc/gateway 8080:8080

8O7PIf84KkuRJYkq32tc180V8


cloud init
#install docker
sudo apt-get update

sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt-get update

sudo apt-get install docker-ce docker-ce-cli containerd.io

#add user to docker group
sudo groupadd docker
sudo usermod -aG docker ${USER}
sudo systemctl restart docker

#create registery
docker run -d -p 5000:5000 --name registry registry:2

#add insecure reg
sudo nano /etc/docker/daemon.json
{
  "insecure-registries" : ["localhost:5000"]
}