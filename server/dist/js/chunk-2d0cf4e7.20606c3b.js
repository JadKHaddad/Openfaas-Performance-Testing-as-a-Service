(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cf4e7"],{"62c8":function(t,e,s){"use strict";s.r(e);s("a4d3"),s("e01a");var i=s("7a23"),n={class:"btn-container"},o=Object(i["h"])("button",{type:"button",class:"btn btn-primary","data-mdb-toggle":"modal","data-mdb-target":"#Modal"}," Start ",-1),r={class:"modal fade",id:"Modal",tabindex:"-1","aria-labelledby":"ModalLabel","aria-hidden":"true"},a={class:"modal-dialog"},c={class:"modal-content"},d=Object(i["h"])("div",{class:"modal-header"},[Object(i["h"])("h5",{class:"modal-title",id:"ModalLabel"},"Start")],-1),l={class:"modal-body"},h={class:"form-outline mb-4"},p=Object(i["h"])("label",{class:"form-label",for:"users-input"},"Users",-1),u={class:"form-outline mb-4"},m=Object(i["h"])("label",{class:"form-label",for:"spawn-rate-input"},"Spawn rate",-1),f={class:"form-outline mb-4"},b=Object(i["h"])("label",{class:"form-label",for:"workers-input"},"Workers",-1),_=Object(i["h"])("div",{class:"form-text",style:{"padding-bottom":"10px"}}," This will overwrite all hosts in your file ",-1),j={class:"form-outline mb-4"},O=Object(i["h"])("label",{class:"form-label",for:"host-input"},"Host",-1),g=Object(i["h"])("div",{class:"form-text",style:{"padding-bottom":"10px"}}," If time is not set, the test will not stop automatically ",-1),v={class:"form-outline mb-4"},y=Object(i["h"])("label",{class:"form-label",for:"time-input"},"Time in seconds",-1),k=Object(i["h"])("div",{class:"form-text",style:{"padding-bottom":"10px"}}," Descripe your test ",-1),w={class:"form-outline mb-4"},U=Object(i["h"])("label",{class:"form-label",for:"description-input"},"Description",-1),S={type:"button",class:"btn btn-primary hidden","data-mdb-dismiss":"modal",id:"dismiss-btn",ref:"dismiss"};function T(t,e,s,T,$,I){var x=Object(i["A"])("Test");return Object(i["v"])(),Object(i["g"])("div",null,[Object(i["h"])("h3",null,Object(i["C"])($.id),1),Object(i["h"])("div",n,[o,Object(i["h"])("button",{type:"button",class:"btn btn-danger",id:"stop-script-tests",onClick:e[0]||(e[0]=function(){return I.stopAll&&I.stopAll.apply(I,arguments)})}," Stop all "),Object(i["h"])("button",{type:"button",class:"btn btn-danger",id:"delete-script-tests",onClick:e[1]||(e[1]=function(){return I.deleteAll&&I.deleteAll.apply(I,arguments)})}," Delete all ")]),(Object(i["v"])(!0),Object(i["g"])(i["a"],null,Object(i["z"])(I.reversedTests,(function(t){return Object(i["v"])(),Object(i["e"])(x,{key:t[0],id:t[0],info:JSON.parse(t[1].info),data:JSON.parse(t[1].data),status:t[1].status,valid:t[1].valid,showPath:!1,url:s.url,openfaasUrl:s.openfaasUrl,pid:$.pid,sid:$.id,startMinimized:s.minimizeTests,mobileAgent:s.mobileAgent,onRestart:I.restart,onDelete:I.deleteTest,onStop:function(e){return I.stop(t[0])}},null,8,["id","info","data","status","valid","url","openfaasUrl","pid","sid","startMinimized","mobileAgent","onRestart","onDelete","onStop"])})),128)),Object(i["h"])("div",r,[Object(i["h"])("div",a,[Object(i["h"])("div",c,[d,Object(i["h"])("div",l,[Object(i["h"])("form",null,[Object(i["h"])("div",h,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"users-input",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=function(t){return $.users=t})},null,512),[[i["F"],$.users]]),p]),Object(i["h"])("div",u,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"spawn-rate-input",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=function(t){return $.spawnRate=t})},null,512),[[i["F"],$.spawnRate]]),m]),Object(i["h"])("div",f,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"workers-input",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=function(t){return $.workers=t})},null,512),[[i["F"],$.workers]]),b]),_,Object(i["h"])("div",j,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"host-input",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=function(t){return $.host=t})},null,512),[[i["F"],$.host]]),O]),g,Object(i["h"])("div",v,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"time-input",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=function(t){return $.time=t})},null,512),[[i["F"],$.time]]),y]),k,Object(i["h"])("div",w,[Object(i["I"])(Object(i["h"])("input",{type:"text",id:"description-input",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=function(t){return $.description=t})},null,512),[[i["F"],$.description]]),U]),Object(i["h"])("button",{type:"button",class:"btn btn-primary btn-block",id:"start-btn",onClick:e[8]||(e[8]=function(){return I.startFromModal&&I.startFromModal.apply(I,arguments)})}," Start ")]),Object(i["h"])("button",S,null,512)])])])])])}s("d3b7"),s("159b"),s("e9c4"),s("b64b"),s("4fad");var $=s("864c"),I={name:"Script",components:{Test:$["a"]},props:["url","openfaasUrl","socket","minimizeTests","update","mobileAgent"],data:function(){return{id:this.$route.params.id,pid:this.$route.params.pid,tests:{},users:"",spawnRate:"",workers:"",host:"",time:"",description:""}},methods:{register:function(t){var e=this;this.socket.off(this.openfaasUrl+"_"+this.pid+"_"+this.id),this.socket.emit("register_script",{openfaasurl:this.openfaasUrl,project_name:this.pid,script_name:this.id,test_ids:t}),this.socket.on(this.openfaasUrl+"_"+this.pid+"_"+this.id,(function(t){if(IsJsonString(t)&&(t=JSON.parse(t),t.success))for(var s=0;s<t.tests.length;s++){var i=t.tests[s].id;if(i in e.tests){var n=t.tests[s].status;0===n?(e.disconnectTest(i),e.tests[i].status=0):1===n?e.tests[i].data=t.tests[s].data:3===n&&(e.tests[i].valid=!1,e.$emit("info",i+": There was an error running this test","red"),e.disconnectTest(i))}}}))},registerTest:function(t){this.socket.emit("register_test",{openfaasurl:this.openfaasUrl,project_name:this.pid,script_name:this.id,test_id:t})},disconnectTest:function(t){this.socket.emit("disconnect_test",{openfaasurl:this.openfaasUrl,project_name:this.pid,script_name:this.id,test_id:t})},init:function(){var t=this;this.host=localStorage.getItem("last_host"),document.querySelectorAll(".form-outline").forEach((function(t){new mdb.Input(t).init()})),fetch(this.url,{method:"POST",body:JSON.stringify({command:7,project_name:this.pid,script_name:this.id})}).then((function(t){return t.json()})).then((function(e){if(e.success){var s=[];for(var i in e.tests)1===e.tests[i].status&&s.push(e.tests[i].id);t.register(s),t.tests=e.tests}})).catch((function(e){t.$emit("info","Could not connect to server","red")})),this.socket.on(this.openfaasUrl+"_"+this.pid+"_"+this.id+"_test_start",(function(e){e.id in t.tests||(t.tests[e.id]=e,t.registerTest(e.id))})),this.socket.on(this.openfaasUrl+"_"+this.pid+"_"+this.id+"_test_delete",(function(e){for(var s=0;s<e.length;s++)e[s]in t.tests&&(delete t.tests[e[s]],t.disconnectTest(e[s]))})),this.socket.on(this.openfaasUrl+"_project_delete_"+this.pid,(function(e){t.$emit("info",t.pid+" is deleted","green"),t.$router.push({name:"Home"})}))},stopAll:function(){var t=this;this.$root.setUpConfirmation(this.id+": Are you sure you want to stop all tests?","Stop",(function(){fetch(t.url,{method:"POST",body:JSON.stringify({command:17,project_name:t.pid,script_name:t.id})}).then((function(t){return t.json()})).then((function(e){if(e.success)for(var s in t.$emit("info","Success","green"),t.socket.emit("disconnect_script",{project_name:t.pid,script_name:t.id}),t.tests)t.tests[s].status=0;else t.$emit("info","There was an error stopping tests","red")})).catch((function(){this.$emit("info","Could not connect to server","red")}))}))},deleteAll:function(){var t=this;this.$root.setUpConfirmation(this.id+": Are you sure you want to delete all tests?","Delete",(function(){fetch(t.url,{method:"POST",body:JSON.stringify({command:16,project_name:t.pid,script_name:t.id})}).then((function(t){return t.json()})).then((function(e){e.success?(t.$emit("info","Success","green"),t.socket.emit("disconnect_script",{project_name:t.pid,script_name:t.id}),t.socket.emit("test_delete",{openfaasurl:t.openfaasUrl,project_name:t.pid,script_name:t.id,ids:Object.keys(t.tests)}),t.tests={}):t.$emit("info","There was an error deleting tests","red")})).catch((function(){this.$emit("info","Could not connect to server","red")}))}))},start:function(t,e,s,i,n,o){var r=this;fetch(this.url,{method:"POST",body:JSON.stringify({command:5,project_name:this.pid,script_name:this.id,users:parseInt(t),spawn_rate:parseInt(e),workers:parseInt(s),host:i,time:parseInt(n),description:o})}).then((function(t){return t.json()})).then((function(a){if(a.success){var c=a.id,d=a.started_at,l=JSON.stringify({users:t,spawn_rate:e,host:i,workers:s,time:n,description:o,started_at:d}),h=1,p=!0,u={id:c,info:l,status:h,valid:p,data:JSON.stringify([])};r.tests[c]=u,r.registerTest(c),r.socket.emit("test_start",{openfaasurl:r.openfaasUrl,project_name:r.pid,script_name:r.id,test:u})}else r.$emit("info",a.message,"red")})).catch((function(){r.$emit("info","Could not connect to server","red")}))},startFromModal:function(){return null!=this.host&&-1==this.host.indexOf("http://")&&-1==this.host.indexOf("https://")&&""!=this.host&&(this.host="http://"+this.host),""===this.users?(this.$emit("info","Users cant be empty","red"),!1):isInteger(this.users)?""===this.spawnRate?(this.$emit("info","Spawn rate cant be empty","red"),!1):isInteger(this.spawnRate)?""===this.workers||isInteger(this.workers)?""==this.time||isInteger(this.time)?(this.$refs.dismiss.click(),""!=this.host&&null!=this.host&&localStorage.setItem("last_host",this.host),void this.start(this.users,this.spawnRate,this.workers,this.host,this.time,this.description)):(this.$emit("info","Time must be an integer","red"),!1):(this.$emit("info","workers must be an integer","red"),!1):(this.$emit("info","Spawn rate must be an integer","red"),!1):(this.$emit("info","Users must be an integer","red"),!1)},restart:function(t){this.start(t.users,t.spawn_rate,t.workers,t.host,t.time,t.description)},deleteTest:function(t){delete this.tests[t],this.socket.emit("test_delete",{openfaasurl:this.openfaasUrl,project_name:this.pid,script_name:this.id,ids:[t]}),this.disconnectTest(t)},stop:function(t){this.socket.emit("test_stop",{openfaasurl:this.openfaasUrl,id:t})}},computed:{reversedTests:function(){return Object.entries(this.tests).reverse()}},beforeUnmount:function(){this.socket.emit("disconnect_script",{project_name:this.pid,script_name:this.id}),this.socket.off(this.openfaasUrl+"_"+this.pid+"_"+this.id),this.socket.off(this.openfaasUrl+"_"+this.pid+"_"+this.id+"_test_start"),this.socket.off(this.openfaasUrl+"_"+this.pid+"_"+this.id+"_test_delete"),this.socket.off(this.openfaasUrl+"_project_delete_"+this.pid)},mounted:function(){this.init()},updated:function(){this.update&&(this.init(),this.$root.updated())}},x=s("6b0d"),A=s.n(x);const J=A()(I,[["render",T]]);e["default"]=J}}]);
//# sourceMappingURL=chunk-2d0cf4e7.20606c3b.js.map