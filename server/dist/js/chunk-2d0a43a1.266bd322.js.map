{"version":3,"sources":["webpack:///./src/views/Control.vue","webpack:///./src/components/InstallationProcess.vue","webpack:///./src/components/InstallationProcess.vue?0085","webpack:///./src/views/Control.vue?5e4f"],"names":["class","type","id","killRunningTasks","deleteAllProjects","projects","project","key","url","openfaasUrl","socket","mobileAgent","deleteProject","reversedTests","test","info","JSON","parse","data","status","valid","showPath","pid","project_name","sid","script_name","startMinimized","minimizeTests","restart","deleteTest","data-mdb-toggle","title","stop","name","props","socketIntv","methods","fetch","this","method","body","stringify","command","then","json","success","$root","showInfo","$emit","catch","beforeUnmount","clearInterval","mounted","setInterval","emit","openfaasurl","on","msg","status_code","console","log","error","__exports__","components","Test","InstallationProcess","tests","register","off","IsJsonString","Object","keys","length","init","i","setUpConfirmation","start","users","spawn_rate","workers","host","time","spawnRate","parseInt","startedAt","started_at","ids","filter","p","computed","entries","reverse","updated","update","render"],"mappings":"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","file":"js/chunk-2d0a43a1.266bd322.js","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"control-btn-container\">\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-danger btn-block control-btn\"\r\n        id=\"kill-btn\"\r\n        @click=\"killRunningTasks\"\r\n      >\r\n        Kill running tasks\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-danger btn-block control-btn\"\r\n        id=\"cleanup-btn\"\r\n        @click=\"deleteAllProjects\"\r\n      >\r\n        Delete all projects\r\n      </button>\r\n    </div>\r\n    <InstallationProcess\r\n      v-for=\"project in projects\"\r\n      :key=\"project\"\r\n      :id=\"project\"\r\n      :url=\"url\"\r\n      :openfaasUrl=\"openfaasUrl\"\r\n      :socket=\"socket\"\r\n      :mobileAgent=\"mobileAgent\"\r\n      @delete=\"deleteProject(project)\"\r\n    >\r\n    </InstallationProcess>\r\n\r\n    <Test\r\n      v-for=\"test in reversedTests\"\r\n      :key=\"test[0]\"\r\n      :id=\"test[0]\"\r\n      :info=\"JSON.parse(test[1].info)\"\r\n      :data=\"JSON.parse(test[1].data)\"\r\n      :status=\"test[1].status\"\r\n      :valid=\"test[1].valid\"\r\n      :showPath=\"true\"\r\n      :url=\"url\"\r\n      :openfaasUrl=\"openfaasUrl\"\r\n      :pid=\"test[1].project_name\"\r\n      :sid=\"test[1].script_name\"\r\n      :startMinimized=\"minimizeTests\"\r\n      :mobileAgent=\"mobileAgent\"\r\n      @restart=\"restart\"\r\n      @delete=\"deleteTest\"\r\n    ></Test>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Test from \"@/components/Test.vue\";\r\nimport InstallationProcess from \"@/components/InstallationProcess.vue\";\r\n\r\nexport default {\r\n  name: \"Control\",\r\n  components: {\r\n    Test,\r\n    InstallationProcess,\r\n  },\r\n  props: [\"url\", \"openfaasUrl\", \"socket\", \"minimizeTests\", \"update\", \"mobileAgent\"],\r\n  data() {\r\n    return {\r\n      tests: {},\r\n      projects: [],\r\n    };\r\n  },\r\n  methods: {\r\n    register() {\r\n      this.socket.off(this.openfaasUrl + \"_control\");\r\n      this.socket.emit(\"register_control\", { openfaasurl: this.openfaasUrl });\r\n      this.socket.on(this.openfaasUrl + \"_control\", (msg) => {\r\n        if (IsJsonString(msg)) {\r\n          msg = JSON.parse(msg);\r\n          if (msg.success) {\r\n            if (\r\n              Object.keys(msg.tests).length >= Object.keys(this.tests).length\r\n            ) {\r\n              for (var key in msg.tests) {\r\n                //console.log(msg.tests[key]);\r\n                const id = msg.tests[key].id;\r\n                if (id in this.tests) {\r\n                  this.tests[id].data = msg.tests[key].data;\r\n                  this.tests[id].valid = msg.tests[key].valid;\r\n                } else {\r\n                  this.tests[id] = msg.tests[key];\r\n                }\r\n              }\r\n            } else {\r\n              for (var key in this.tests) {\r\n                if (key in msg.tests) {\r\n                  //console.log(msg.tests[key]);\r\n                  const id = msg.tests[key].id;\r\n                  if (id in this.tests) {\r\n                    this.tests[id].data = msg.tests[key].data;\r\n                    this.tests[id].valid = msg.tests[key].valid;\r\n                  } else {\r\n                    this.tests[id] = msg.tests[key];\r\n                  }\r\n                } else {\r\n                  this.tests[key].status = 0;\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n      // console.log(\"control registered\")\r\n    },\r\n    init() {\r\n      //get running tests\r\n      fetch(this.url, { method: \"POST\", body: JSON.stringify({ command: 13 }) })\r\n        .then((data) => data.json())\r\n        .then((data) => {\r\n          if (data.success) {\r\n            this.tests = data.tests;\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$emit(\"info\", \"Could not connect to server\", \"red\");\r\n        });\r\n      //get installing projects\r\n      fetch(this.url, { method: \"POST\", body: JSON.stringify({ command: 1 }) })\r\n        .then((data) => data.json())\r\n        .then((data) => {\r\n          if (data.success) {\r\n            this.projects = data.projects;\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$emit(\"info\", \"Could not connect to server\", \"red\");\r\n        });\r\n      this.register();\r\n      this.socket.on(this.openfaasUrl + \"_control_test_delete\", (msg) => {\r\n        for (var i = 0; i < msg.length; i++) {\r\n          if (msg[i] in this.tests) {\r\n            delete this.tests[msg[i]];\r\n          }\r\n        }\r\n      });\r\n      this.socket.on(this.openfaasUrl + \"_control_test_stop\", (msg) => {\r\n        if (msg in this.tests) {\r\n          this.tests[msg].status = 0;\r\n        }\r\n      });\r\n    },\r\n    killRunningTasks() {\r\n      this.$root.setUpConfirmation(\r\n        \"Kill all running tasks? Istallation tasks will also be killed\",\r\n        \"Kill\",\r\n        () => {\r\n          fetch(this.url, {\r\n            method: \"POST\",\r\n            body: JSON.stringify({ command: 911 }),\r\n          })\r\n            .then((data) => data.json())\r\n            .then((data) => {\r\n              if (data.success) {\r\n                this.$emit(\"info\", \"Success\", \"green\");\r\n                for (var key in this.tests) {\r\n                  this.tests[key].status = 0;\r\n                }\r\n              } else {\r\n                this.$emit(\r\n                  \"info\",\r\n                  \"There was an error killing running tasks\",\r\n                  \"red\"\r\n                );\r\n              }\r\n            })\r\n            .catch(() => {\r\n              this.$emit(\"info\", \"Could not connect to server\", \"red\");\r\n            });\r\n        }\r\n      );\r\n    },\r\n    deleteAllProjects() {\r\n      this.$root.setUpConfirmation(\"Delete all projects?\", \"Delete\", () => {\r\n        fetch(this.url, {\r\n          method: \"POST\",\r\n          body: JSON.stringify({ command: 912 }),\r\n        })\r\n          .then((data) => data.json())\r\n          .then((data) => {\r\n            if (data.success) {\r\n              this.$emit(\"info\", \"Success\", \"green\");\r\n              this.socket.emit(\"clean_up\", {\r\n                openfaasurl: this.openfaasUrl,\r\n              });\r\n              this.tests = {};\r\n            } else {\r\n              this.$emit(\"info\", \"There was an error deleting projects\", \"red\");\r\n            }\r\n          })\r\n          .catch(() => {\r\n            this.$emit(\"info\", \"Could not connect to server\", \"red\");\r\n          });\r\n      });\r\n    },\r\n    restart(info, pid, sid) {\r\n      this.start(\r\n        info.users,\r\n        info.spawn_rate,\r\n        info.workers,\r\n        info.host,\r\n        info.time,\r\n        pid,\r\n        sid\r\n      );\r\n    },\r\n    start(users, spawnRate, workers, host, time, pid, sid) {\r\n      fetch(this.url, {\r\n        method: \"POST\",\r\n        body: JSON.stringify({\r\n          command: 5,\r\n          project_name: pid,\r\n          script_name: sid,\r\n          users: parseInt(users),\r\n          spawn_rate: parseInt(spawnRate),\r\n          workers: parseInt(workers),\r\n          host: host,\r\n          time: parseInt(time),\r\n        }),\r\n      })\r\n        .then((data) => data.json())\r\n        .then((data) => {\r\n          if (data.success) {\r\n            const id = data.id;\r\n            const startedAt = data.started_at;\r\n            const info = JSON.stringify({\r\n              users: users,\r\n              spawn_rate: spawnRate,\r\n              host: host,\r\n              workers: workers,\r\n              time: time,\r\n              started_at: startedAt,\r\n            });\r\n            const status = 1;\r\n            const valid = true;\r\n            const test = {\r\n              id: id,\r\n              info: info,\r\n              status: status,\r\n              valid: valid,\r\n              project_name: pid,\r\n              script_name: sid,\r\n              data: JSON.stringify([]),\r\n            };\r\n            this.tests[id] = test;\r\n            this.socket.emit(\"test_start\", {\r\n              openfaasurl: this.openfaasUrl,\r\n              project_name: pid,\r\n              script_name: sid,\r\n              test: test,\r\n            });\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$emit(\"info\", \"Could not connect to server\", \"red\");\r\n        });\r\n    },\r\n    deleteTest(id, pid, sid) {\r\n      delete this.tests[id];\r\n      this.socket.emit(\"test_delete\", {\r\n        openfaasurl: this.openfaasUrl,\r\n        project_name: pid,\r\n        script_name: sid,\r\n        ids: [id],\r\n      });\r\n    },\r\n    deleteProject(project) {\r\n      this.projects = this.projects.filter((p) => p !== project);\r\n    },\r\n  },\r\n  computed: {\r\n    reversedTests() {\r\n      return Object.entries(this.tests).reverse();\r\n    },\r\n  },\r\n  beforeUnmount() {\r\n    this.socket.emit(\"disconnect_control\");\r\n    this.socket.off(this.openfaasUrl + \"_control\");\r\n    this.socket.off(this.openfaasUrl + \"_control_test_delete\");\r\n    this.socket.off(this.openfaasUrl + \"_control_test_stop\");\r\n    // console.log(\"control disconnected\")\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  updated() {\r\n    if (this.update) {\r\n      this.init();\r\n      this.$root.updated();\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","<template>\r\n<div v-if=\"!mobileAgent\">\r\n  <div class=\"card project-card\" :id=\"id\">\r\n    <div class=\"card-body\">\r\n      <div class=\"row\">\r\n        <div\r\n          class=\"col-10 project_name\"\r\n          data-mdb-toggle=\"tooltip\"\r\n          title=\"Project name\"\r\n        >\r\n          Installing project: {{ id }}\r\n        </div>\r\n        <div class=\"col-1\">\r\n          <div\r\n            class=\"spinner-border text-primary spinner\"\r\n            data-mdb-toggle=\"tooltip\"\r\n            title=\"Running\"\r\n          ></div>\r\n        </div>\r\n        <div class=\"col-1\" data-mdb-toggle=\"tooltip\" title=\"Cancel\">\r\n          <i class=\"fas fa-times stop-install-project\" @click=\"stop\"></i>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div v-else>\r\n  <div class=\"card project-card no-width\" :id=\"id\">\r\n    <div class=\"card-body\">\r\n\r\n        <div\r\n          class=\"vertical-entry project_name\"\r\n          data-mdb-toggle=\"tooltip\"\r\n          title=\"Project name\"\r\n        >\r\n          Installing project: {{ id }}\r\n        </div>\r\n        <div class=\"vertical-entry\" data-mdb-toggle=\"tooltip\" title=\"Cancel\">\r\n          <i class=\"fas fa-times stop-install-project\" @click=\"stop\"></i>\r\n        </div>\r\n\r\n    </div>\r\n  </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"InstallationProcess\",\r\n  props: [\"id\", \"url\", \"openfaasUrl\", \"socket\", \"mobileAgent\"],\r\n  data() {\r\n    return {\r\n      socketIntv: null,\r\n    };\r\n  },\r\n  methods: {\r\n    stop() {\r\n      fetch(this.url, {\r\n        method: \"POST\",\r\n        body: JSON.stringify({ command: 15, project_name: this.id }),\r\n      })\r\n        .then((data) => data.json())\r\n        .then((data) => {\r\n          if (data.success) {\r\n            this.$root.showInfo(\r\n              this.id + \": installation canceled successfully\",\r\n              \"green\"\r\n            );\r\n            this.$emit(\"delete\");\r\n          } else {\r\n            this.$root.showInfo(\r\n              \"There was an error canceling the installation\",\r\n              \"red\"\r\n            );\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.$root.showInfo(\"Could not connect to server\", \"red\");\r\n        });\r\n    },\r\n  },\r\n  beforeUnmount() {\r\n    if (this.socketIntv) clearInterval(this.socketIntv);\r\n  },\r\n  mounted() {\r\n    this.socketIntv = setInterval(() => {\r\n      this.socket.emit(\"task_stats\", {\r\n        project_name: this.id,\r\n        openfaasurl: this.openfaasUrl,\r\n      });\r\n    }, 1000);\r\n    this.socket.on(this.id, (msg) => {\r\n      const data = JSON.parse(msg.data);\r\n      if (!data.success) {\r\n        console.log(\"Something went wrong\");\r\n        this.$root.showInfo(\"Something went wrong\", \"red\");\r\n        clearInterval(this.socketIntv);\r\n      } else if (data.status_code === 3) {\r\n        console.log(\"thread is locking\");\r\n      } else if (data.status_code === 2) {\r\n        console.log(\"installing project\");\r\n      } else if (data.status_code === 1) {\r\n        console.log(\"installing failed\");\r\n        clearInterval(this.socketIntv);\r\n        this.$root.showInfo(\r\n          \"Installation failed\",\r\n          \"red\",\r\n          data.error\r\n        );\r\n        this.$emit(\"delete\");\r\n      } else {\r\n        console.log(\"Task is finished\");\r\n        clearInterval(this.socketIntv);\r\n        this.$emit(\"delete\");\r\n        this.$root.showInfo(\"Installation successs\", \"green\");\r\n      }\r\n    });\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import { render } from \"./InstallationProcess.vue?vue&type=template&id=157716b4\"\nimport script from \"./InstallationProcess.vue?vue&type=script&lang=js\"\nexport * from \"./InstallationProcess.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\MegaSync\\\\Dokumente\\\\Meine Unterlagen\\\\WWU Münster\\\\Fächer\\\\7 - WS 21\\\\Bachelorarbeit\\\\PTAS\\\\vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Control.vue?vue&type=template&id=c9f182b0\"\nimport script from \"./Control.vue?vue&type=script&lang=js\"\nexport * from \"./Control.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\MegaSync\\\\Dokumente\\\\Meine Unterlagen\\\\WWU Münster\\\\Fächer\\\\7 - WS 21\\\\Bachelorarbeit\\\\PTAS\\\\vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}